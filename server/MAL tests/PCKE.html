<!--MAL only allows the plain transformation for the Code Challenge. In other words, it means that you have to set the Code Challenge equal to the Code Verifier. Simple.-->


<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Static Template</title>
  </head>
  <style>
    body {
      font-family: BlinkMacSystemFont, -apple-system, "Segoe UI", "Roboto",
        "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans",
        "Helvetica Neue", "Helvetica", "Arial", sans-serif;
    }
  </style>
  <script>
    // GENERATING CODE VERIFIER
    function dec2hex(dec) {
      return ("0" + dec.toString(16)).substr(-2);
    }
    function generateCodeVerifier() {
      var array = new Uint32Array(56 / 2);
      window.crypto.getRandomValues(array);
      return Array.from(array, dec2hex).join("");
    }
    function getCodeVerifier() {
      document.getElementById("code_verifier").value = generateCodeVerifier();
    }

    function Login() {
      let code_challenge = getCodeVerifier();
      //!!! REMOVE BEFORE PUSHING
      let client_id = "a946882c1c14504ec8a3046fcc5513ef";
      let url = `https://myanimelist.net/v1/oauth2/authorize?response_type=code
      &client_id=${client_id}
      &code_challenge=${code_challenge}
      &state=RequestID42`;
      document.getElementById("loginbutton").value = url;
    }
    
  </script>
  <body>
    <h3>
      Example Code Verifier & Code Challenge for OAuth 2.0 PKCE Flow
    </h3>
    <div>Step 1. Generate Code Verifier</div>
    <input type="text" id="code_verifier" value="" style="width: 500px;" />
    <br />
    <button onClick="getCodeVerifier()">Generate Code Verifier</button>

    <br />
    <br />
    <div>Step 2. Generate Code Challenge from Code Verifier</div>
    <input type="text" id="code_challenge" value="" style="width: 500px;" />
    <br />
    <button onClick="Login()">
      Generate Code Challenge from Code Verifier
    </button>
  </body>
</html>
